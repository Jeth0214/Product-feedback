import{a as A}from"./chunk-ONEN2AC2.js";import{a as G,b as C,c as P,d as z,e as M,f as j,g as q,h as H,i as $,j as X}from"./chunk-ZOQ63MJE.js";import{a as w,c as O,d as N}from"./chunk-X77DX7YH.js";import{a as R}from"./chunk-W4RJ5YNC.js";import{c as D,s as I,u as V,v as U}from"./chunk-HRO62DS5.js";import"./chunk-W4BNGQYG.js";import{Ab as m,D as v,Ib as s,Kb as F,La as T,Pa as r,U as f,Xb as L,_a as E,a as k,aa as b,b as S,ba as h,cb as u,fa as B,ib as l,nb as c,rb as o,sb as n,tb as _,wb as g,zb as x}from"./chunk-ZODXZFG3.js";var y=(p=>(p.Feature="Feature",p.UI="UI",p.UX="UX",p.Enhancement="Enhancement",p.Bug="Bug",p))(y||{});function K(i,t){i&1&&(o(0,"small",19),s(1,"Can't be empty"),n())}function Q(i,t){i&1&&(o(0,"small",19),s(1,"Must be at least 5 characters"),n())}function W(i,t){if(i&1&&u(0,K,2,0,"small",19)(1,Q,2,0,"small",19),i&2){let e,a,d=m(2);c(!((e=d.feedBackform.get("title"))==null||e.errors==null)&&e.errors.required?0:-1),r(),c(!((a=d.feedBackform.get("title"))==null||a.errors==null)&&a.errors.minlength?1:-1)}}function Y(i,t){if(i&1){let e=g();o(0,"div",9)(1,"h2"),s(2,"Category"),n(),o(3,"label",20),s(4,"Choose a category for your feedback"),n(),o(5,"app-dropdown",21),x("processOption",function(d){b(e);let p=m(2);return h(p.onSelectCategory(d))}),n()()}if(i&2){let e=m(2);r(5),l("defaultOption",e.selectedCategory)("dropDownOptions",e.categories)("dropDownType","block")("dropDownArrowColor","blue")}}function Z(i,t){if(i&1){let e=g();o(0,"div",9)(1,"h2"),s(2,"Update Status"),n(),o(3,"label",22),s(4,"Change feature state"),n(),o(5,"app-dropdown",21),x("processOption",function(d){b(e);let p=m(2);return h(p.onSelectStatus(d))}),n()()}if(i&2){let e=m(2);r(5),l("defaultOption",e.selectedStatus)("dropDownOptions",e.statuses)("dropDownType","block")("dropDownArrowColor","blue")}}function ee(i,t){i&1&&(o(0,"small",19),s(1,"Can't be empty"),n())}function te(i,t){i&1&&(o(0,"small",19),s(1,"Must be at least 5 characters"),n())}function ie(i,t){if(i&1&&u(0,ee,2,0,"small",19)(1,te,2,0,"small",19),i&2){let e,a,d=m(2);c(!((e=d.feedBackform.get("description"))==null||e.errors==null)&&e.errors.required?0:-1),r(),c(!((a=d.feedBackform.get("description"))==null||a.errors==null)&&a.errors.minlength?1:-1)}}function oe(i,t){if(i&1){let e=g();o(0,"div",15)(1,"button",23),x("click",function(){b(e);let d=m(2);return h(d.deleteFeedBack())}),s(2),n()()}if(i&2){let e=m(2);r(),l("disabled",e.isLoading),r(),F(" ",e.deleteButtonText," ")}}function ne(i,t){if(i&1){let e=g();o(0,"form",8),x("ngSubmit",function(){b(e);let d=m();return h(d.onSubmit())}),o(1,"div",9)(2,"h2"),s(3,"Feedback Title"),n(),o(4,"label",10),s(5,"Add a short, descriptive headline"),n(),_(6,"input",11),u(7,W,2,2),n(),u(8,Y,6,4,"div",9)(9,Z,6,4,"div",9),o(10,"div",9)(11,"h2"),s(12,"Feedback Detail"),n(),o(13,"label",12),s(14,"Include any specific comments on what should be improved, added, etc."),n(),_(15,"textarea",13),u(16,ie,2,2),n(),o(17,"div",14),u(18,oe,3,2,"div",15),o(19,"div",16)(20,"button",17),s(21," Cancel "),n(),o(22,"button",18),s(23),n()()()()}if(i&2){let e=m();l("formGroup",e.feedBackform),r(6),l("ngClass",e.hasError("title")?"border-red":"border-white focus:outline-none focus:border-blue focus:ring-1 focus:ring-blue hover:border-blue hover:ring-1 hover:ring-blue"),r(),c(e.hasError("title")?7:-1),r(),c(e.selectedCategory?8:-1),r(),c(e.selectedStatus?9:-1),r(6),l("ngClass",e.hasError("description")?"border-red":"border-white focus:outline-none focus:border-blue focus:ring-1 focus:ring-blue hover:border-blue hover:ring-1 hover:ring-blue"),r(),c(e.hasError("description")?16:-1),r(),l("ngClass",e.id?"md:justify-between":"md:justify-end"),r(),c(e.id?18:-1),r(2),l("disabled",e.isLoading),r(2),l("disabled",e.feedBackform.invalid||e.isLoading),r(),F(" ",e.submitButtonText," ")}}var J=class i{_activatedRoute=f(I);formBuilder=f($);_feedbackService=f(O);_toastrService=f(R);_router=f(V);_destroyRef=f(B);selectedFeedBack=this._feedbackService.selectedFeedBack;formIcon="assets/shared/icon-new-feedback.svg";title="Create New Feedback";submitButtonText="Add Feedback";deleteButtonText="Delete";id=0;isLoading=!1;feedBackform=new M({});categories=Object.keys(y);statuses=["Suggestion","Planned","In-Progress","Live"];selectedCategory=this.dropdownValueToTitleCase(this.categories[0]);selectedStatus="";constructor(){this._activatedRoute.paramMap.subscribe(t=>{let e=t.get("id");this.id=e?+e:0,this.id&&this._feedbackService.getFeedBackById(this.id)}),L(()=>{let t=this.selectedFeedBack();this.initializeFormEffect(t)})}initializeFormEffect(t){t&&this.id?(this.setUpForm(t),this.formIcon="assets/shared/icon-edit-feedback.svg",this.title=`Editing '${this.selectedFeedBack().title}'`,this.selectedCategory=this.dropdownValueToTitleCase(t.category),this.selectedStatus=this.dropdownValueToTitleCase(t.status),this.submitButtonText="Update Feedback"):(this.selectedCategory=this.dropdownValueToTitleCase(this.categories[0]),this.setUpForm())}hasError(t){let e=this.feedBackform.get(t);return!!(e&&e.invalid&&e?.touched)}setUpForm(t){this.feedBackform=this.formBuilder.group({title:[t?.title??"",[C.required,C.minLength(5)]],description:[t?.description??"",[C.required,C.minLength(5)]]})}onSelectCategory(t){this.selectedCategory=t.toLowerCase()}onSelectStatus(t){this.selectedStatus=t.toLowerCase()}onSubmit(){if(this.feedBackform.invalid)return;let t=this.feedBackform.value;this.selectedFeedBack()&&this.id?this.updateFeedBack(t):this.addFeedBack(t)}updateFeedBack(t){this.isLoading=!0,this.submitButtonText="Updating...";let e=S(k(k({},this.selectedFeedBack()),t),{category:this.selectedCategory.toLowerCase(),status:this.selectedStatus.toLowerCase()});this._feedbackService.updateFeedBack(e).pipe(v(()=>{this.isLoading=!1,this.submitButtonText="Update Feedback"}),w(this._destroyRef)).subscribe({next:()=>{this._toastrService.success("Feedback updated successfully","Success"),this._router.navigate(["/feedbacks"])},error:a=>{this._toastrService.error("Failed to Update feedback",`Status: ${a.status}`)}})}addFeedBack(t){this.isLoading=!0,this.submitButtonText="Adding...";let e=S(k({},t),{category:this.selectedCategory.toLowerCase(),status:this.selectedStatus.toLowerCase(),upvotes:0,comments:[]});this._feedbackService.addFeedBack(e).pipe(v(()=>{this.isLoading=!1,this.submitButtonText="Add Feedback"}),w(this._destroyRef)).subscribe({next:()=>{this._toastrService.success("Feedback added successfully","Success"),this.feedBackform.reset(),this._router.navigate(["/feedbacks"])},error:a=>{this._toastrService.error("Failed to add feedback",`Status: ${a.status}`)}})}deleteFeedBack(){this.isLoading=!0,this.deleteButtonText="Deleting...",this._feedbackService.deleteFeedBack(this.id).pipe(v(()=>{this.isLoading=!1,this.deleteButtonText="Delete"}),w(this._destroyRef)).subscribe({next:()=>{this._toastrService.success("Feedback deleted successfully","Success"),this._router.navigate(["/feedbacks"])},error:t=>{this._toastrService.error("Failed to delete feedback",`Status: ${t.status}`)}})}dropdownValueToTitleCase(t){return t?t.includes("-")?t.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join("-"):t.charAt(0).toUpperCase()+t.slice(1):""}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=E({type:i,selectors:[["app-feedback-form"]],decls:13,vars:4,consts:[[1,"max-w-xl","mx-auto","my-6","md:my-10","px-6"],[3,"full"],["routerLink","/",1,"text-sm","flex","items-center","gap-3","cursor-pointer","transition","font-bold","hover:underline"],["loading","lazy","src","./assets/shared/icon-blue-arrow-left.svg","alt","arrow left"],[1,"bg-white","rounded-lg","p-5","md:p-10","mt-12","md:mt-20"],["alt","form icon","loading","lazy",1,"-mt-12","md:-mt-16",3,"src"],[1,"text-2xl","mt-3"],[1,"mt-10",3,"formGroup"],[1,"mt-10",3,"ngSubmit","formGroup"],[1,"mt-10"],["for","title",1,"text-sm","text-dark-500"],["type","text","id","title","formControlName","title",1,"w-full","mt-4","py-3","px-6","text-dark-800","bg-light-800","rounded-lg","border",3,"ngClass"],["for","description",1,"text-sm","text-dark-500"],["id","description","formControlName","description","rows","5",1,"w-full","mt-4","py-3","px-6","text-dark-800","bg-light-800","rounded-lg","border",3,"ngClass"],[1,"mt-10","flex","flex-wrap","gap-3","font-bold","md:flex-nowrap","md:items-start",3,"ngClass"],[1,"w-full","md:w-auto","order-3","md:order-1"],[1,"w-full","md:w-auto","flex","flex-col-reverse","md:flex-row","gap-3","md:gap-3","order-2","md:order-2"],["type","button","routerLink","/feedbacks",1,"w-full","md:w-auto","py-3","px-6","bg-dark-800","text-light-800","rounded-lg","hover:bg-dark-500","transition",3,"disabled"],["type","submit",1,"w-full","md:w-auto","py-3","px-6","bg-purple","text-white","rounded-lg","hover:bg-purple-500","transition",3,"disabled"],[1,"text-red","text-sm","mt-3"],["for","category",1,"text-sm","text-dark-500"],[3,"processOption","defaultOption","dropDownOptions","dropDownType","dropDownArrowColor"],["for","status",1,"text-sm","text-dark-500"],["type","button",1,"w-full","py-3","px-6","bg-red","text-light-800","rounded-lg","hover:bg-red-500","transition",3,"click","disabled"]],template:function(e,a){e&1&&(o(0,"main",0),_(1,"app-loading",1),o(2,"div")(3,"a",2),_(4,"img",3),o(5,"span"),s(6,"Go Back"),n()()(),o(7,"div",4)(8,"div"),_(9,"img",5),o(10,"h1",6),s(11),n()(),u(12,ne,24,12,"form",7),n()()),e&2&&(r(),l("full",!0),r(8),l("src",a.formIcon,T),r(2),F(" ",a.title," "),r(),c(a.feedBackform?12:-1))},dependencies:[U,A,X,j,G,P,z,q,H,D,N],encapsulation:2})};export{J as FeedbackFormComponent};
